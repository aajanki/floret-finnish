# Evaluating the trained model

## Download the fastText model

See [pre-trained fastText models](https://fasttext.cc/docs/en/crawl-vectors.html).

```sh
mkdir -p fasttext_models
wget -O - https://dl.fbaipublicfiles.com/fasttext/vectors-crawl/cc.fi.300.bin.gz | gunzip > fasttext_models/cc.fi.300.bin
wget -O - https://dl.fbaipublicfiles.com/fasttext/vectors-crawl/cc.fi.300.vec.gz | gunzip > fasttext_models/cc.fi.300.vec
```

## Eduskunta-vkk

Task: Predict a class for each sentence. Sentence vectors generated by the model + an SVM classifier.

Data: https://github.com/aajanki/eduskunta-vkk

```sh
# Download and prepare training data
mkdir -p evaluation/data/eduskunta-vkk
wget --directory-prefix=evaluation/data/eduskunta-vkk https://github.com/aajanki/eduskunta-vkk/raw/v2/vkk/train.csv.bz2
wget --directory-prefix=evaluation/data/eduskunta-vkk https://github.com/aajanki/eduskunta-vkk/raw/v2/vkk/dev.csv.bz2
wget --directory-prefix=evaluation/data/eduskunta-vkk https://github.com/aajanki/eduskunta-vkk/raw/v2/vkk/test.csv.bz2

python evaluation/eduskunta-vkk/prepare_train_data.py

# Evaluate fastText
python evaluation/eduskunta-vkk/eval.py fasttext_models/cc.fi.300.bin

# Evaluate floret
python evaluation/eduskunta-vkk/eval.py trained_models/fi-300-50k-minn3-maxn5-epoch5.bin
```

## QVEC

[QVEC](http://www.cs.cmu.edu/~ytsvetko/papers/qvec.pdf) is a tool for measuring the instrinsic quality of word vectors. The evaluation score is related to how well the word vectors can predict morphological features.

```sh
# Get QVEC
git clone https://github.com/ytsvetko/qvec.git

# Construct a morphological feature file for the most common Finnish words
mkdir -p evaluation/data/qvec
wget --directory-prefix=evaluation/data/qvec http://bionlp-www.utu.fi/.jmnybl/finnish_vocab.txt.gz
zcat evaluation/data/qvec/finnish_vocab.txt.gz \
    | awk '{$1=$1;print}' \
    | cut -d' ' -f 2 \
    | head -n 10000 \
    | python evaluation/qvec/create_qvec_oracle.py \
    > evaluation/data/qvec/morhps.fi

# Evaluate fastText
python qvec/qvec_cca.py --in_vectors fasttext_models/cc.fi.300.vec --in_oracle evaluation/data/qvec/morhps.fi

# Evaluate floret
python qvec/qvec_cca.py --in_vectors trained_models/fi-300-50k-minn3-maxn5-epoch5.vec --in_oracle evaluation/data/qvec/morhps.fi
```
